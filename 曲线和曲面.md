# 曲线和曲面

## Cubic Curves

由于其使用的简单和灵活性，三次多项式曲线再计算机图形中应用很广泛。一个基础的三次曲线可以由以下式子表示：
$$
Q(t) = a+bt+ct^2+dt^3
$$
![undefined](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/Cubic_function.png)

其中$a$,$b$,$c$,$d$均为常向量，$Q(t)$​是曲线上关于t的一个点，将公式拆分为坐标轴分量形式，可以表示为:
$$
Q_x(t) = a_x+b_xt+c_xt^2+d_xt^3\\
Q_y(t) = a_y+b_yt+c_yt^2+d_yt^3\\
Q_z(t) = a_z+b_zt+c_zt^2+d_zt^3\\
$$
通过矩阵的方式来表示上述式子将更加方便，如下所示：
$$
Q(t) = \begin{bmatrix}a_x&b_x&c_x&d_x\\a_y&b_y&c_y&d_y\\a_z&b_z&c_z&d_z\end{bmatrix}\begin{bmatrix}1\\t\\t^2\\t^3\end{bmatrix}
$$
用更加紧（抽）凑（像）的符号表示，可以写成
$$
Q(t) = CT(t)
$$
这里的$C$代表矩阵的参数，$T(t)\equiv<1,t,t^2,t^3>$。$Q(t)$的导数可以代表曲线的t的位置时的切线方向，可以表示为如下：
$$
Q'(t)=C\frac{d}{dt}T(t)=C\begin{bmatrix}0\\1\\2t\\3t^3\end{bmatrix}
$$
一条很长的曲线可以看成是由多个分段的三次曲线连接端点组成的。在相邻的两个分段的连接点处，有参数连续性和几何连续性的概念。符号$C^n$用于表示n阶参数连续性，$G^n$用于表示n阶几何连续性。如果两个曲线在连接点处具有一样方向和大小的切线，则被成为具有$C^1$连续性。如果切线有同样的方向，但是不一样的大小，则被称为具有$G^1$连续性。通常来说，两个曲线如果n阶导相等，则$C^{n}$连续，如果n阶导不为0且方向相同，大小不同，则具有$G^{n}$连续。$C^{n}$连续就隐含了$G^{n}$连续，除非n阶导为0。而$C^0$和$G^0$​是等价的，表示曲线具有一样的端点。



**参数连续性确保了拼接的分段曲线，在区间内的是连续的。**

**几何连续性确保了在区间内，曲线是平滑的。**



本章节中我们定义的三次曲线，是通过特定的几何约束来表示的。例如端点位置（比如：$Q(0)$, Q(1)）或者端点的切向方向（比如：$Q'(0),Q’(1)$）。由于定义一个任意的三次曲线，需要四个参数来约束（因为有四个系数$a,b,c,d$，要求出四个系数，至少需要四个点代入才能解出来），我们将约束点命名为$g_1,g_2,g_3,g_4$，可以将$Q(t)$表示为：
$$
Q(t) = (a_1+b_1t+c_1t^2+d_1t^3)g_1\\+(a_2+b_2t+c_2t^2+d_2t^3)g_2\\+(a_3+b_3t+c_3t^2+d_3t^3)g_3\\+(a_4+b_4t+c_4t^2+d_4t^3)g_4\\
$$
上式可以看成是一个加权和的形式，而式子$a_i+b_it+c_it+d_it$又被称为blending funtions。写成矩阵形式如下：
$$
Q(t)=\begin{bmatrix}g_1&g_2&g_3&g_4\end{bmatrix}\begin{bmatrix}a_1&b_1&c_1&d_1\\a_2&b_2&c_2&d_2\\a_3&b_3&c_3&d_3\\a_4&b_4&c_4&d_4\end{bmatrix}\begin{bmatrix}1\\t\\t^2\\t^3\end{bmatrix}
$$
同样的，抽象写法如下：
$$
Q(t)=GMT(t)
$$
总结一下就是，任何曲线，都可以通过基函数和参数的叠加多项式来拟合，类似泰勒展开式的感觉。g就是权重参数，基函数一般用三次多项式来表示，至于为什么选用三次多项式，主要是由于三次多项式可以比较方便的构造出类似smoothstep的曲线。

![undefined](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/1920px-Smoothstep_and_Smootherstep.svg.png)



关于上式的矩阵$G$,定义如下：
$$
G = \begin{bmatrix}g_1&g_2&g_3&g_4\end{bmatrix}=\begin{bmatrix}(g_1)_x&(g_2)_x&(g_3)_x&(g_4)_x\\(g_1)_y&(g_2)_y&(g_3)_y&(g_4)_y\\(g_1)_z&(g_2)_z&(g_3)_z&(g_4)_z\end{bmatrix}
$$
矩阵$M$定义如下：
$$
M=\begin{bmatrix}a_1&b_1&c_1&d_1\\a_2&b_2&c_2&d_2\\a_3&b_3&c_3&d_3\\a_4&b_4&c_4&d_4\\\end{bmatrix}
$$
$M$矩阵用来定义基函数，$G$​矩阵用来控制形状。





## Hermite Curves

一个三次Hermite曲线是由两个端点$P_1,P_2$，和对应的切线方向$T_1,T_2$来控制的。用这四个量来定义$G$矩阵，可以把Hermite曲线定义如下：


$$
H(t)=\begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H\begin{bmatrix}1\\t\\t^2\\t^3\end{bmatrix}
$$
$M_H$是基函数的参数矩阵，$G$矩阵为$\begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}$。这里我们分别取两点（t=0和t=1），可以得到下面四个等式：
$$
H(0)  = \begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H<1, 0, 0, 0> = P_1\\
H(1)= \begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H<1, 1, 1, 1> = P_2\\
H'(0) = \begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H<0, 1, 0, 0> = T_1\\
H’(1) = \begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H<0, 1, 2, 3> = T_2\\
$$
将上式用矩阵的形式合并运算可以写成：
$$
\begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}M_H\begin{bmatrix}1&1&0&0\\0&1&1&1\\0&1&0&2\\0&1&0&3\end{bmatrix} = \begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}
$$
因此，可以推断出矩阵$M_{H}$其实就是右边常数矩阵的逆：
$$
M_H=\begin{bmatrix}1&1&0&0\\0&1&1&1\\0&1&0&2\\0&1&0&3\end{bmatrix}^{-1}=\begin{bmatrix}1&0&-3&2\\0&0&3&-2\\0&1&-2&1\\0&0&-1&1\end{bmatrix}
$$
得到参数矩阵后，可以把式子写成加权和的形式：
$$
H(t)=(1-3t^2+2t^3)P_1+t^2(3-2t)P_2+t(t-1)^2T_1+t^2(t-1)T_2
$$


通过上式可以看到，当t=0时，只有$P_1$的系数不为0，当t=1时，只有$P_2$的系数不为0。如下图所示：

![image-20240520175926206](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240520175926206.png)



下图展示的是两个Hermite曲线的拼接，曲线分别为$H_1(t)$和$H_2(t)$，他们共享了一个端点$P_{2}$。如果曲线$H_1(t)$的几何矩阵是$\begin{bmatrix}P_1&P_2&T_1&T_2\end{bmatrix}$，并且曲线$H_2(t)$的几何矩阵是$\begin{bmatrix}P_2&P_3&\mu T_2&T_3\end{bmatrix} \space(\mu>0)$，则这两段曲线满足$G^1$连续，如果$\mu=1$则满足$C^1$连续。

![image-20240520181445730](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240520181445730.png)



## Bezier Curves

虽然我们目前主要研究三次方程，但是贝塞尔曲线可以定义为任意n次多项式。给定$n+1$个点$\{P_0,P_1,...,P_n\}$作为曲线的控制点，n次贝塞尔曲线$B(t)$可以用下面的方程定义：
$$
B(t)=\sum_{k=0}^{n}{B_{n,k}(t)P_k}
$$
其中Blending Function$B_{n,k}$是Bernstein多项式，定义如下：
$$
B_{n,k}=\begin{pmatrix}n \\k\end{pmatrix}t^k(1-t)^{n-k}
$$
其二项式系数定义如下:
$$
\begin{pmatrix}n \\k\end{pmatrix} = \frac{n!}{k!(n-k)!}
$$
曲线会插值第一个控制点$P_0$和最后一个控制点$P_n$。其余的点，则是通过曲线近似。Bernstein多项式可以由以下递推式得到：
$$
B_{n,k}(t)=(1-t)B_{n-1,k-1}+tB_{n-1,k}
$$
且$B_{0,0}=1,B_{n,k}=0$,当$k<0或者k>n$。下图展示了由递推式得出的Pascal三角形

![image-20240527195712271](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240527195712271.png)

### Cubic Bezier Curves

三次贝塞尔曲线由四个控制点进行插值得到
$$
B(t)=\sum_{k=0}^{3}B_{3,k}(t)P_{k} = (1-t)^3P_0+3t(1-t)^2P_1+3t^2(1-t)P_2+t^3P_3
$$

三次贝塞尔曲线的几何矩阵是$G_B=\begin{bmatrix}P_0&P_1&P_2&P_3\end{bmatrix}$。上述的式子，也可以写成以下形式：
$$
B(t)=\begin{bmatrix}P_0&P_1&P_2&P_3\end{bmatrix}\begin{bmatrix}1&-3&3&-1\\
0&3&-6&3\\
0&0&3&-3\\
0&0&0&1\end{bmatrix}\begin{bmatrix}1\\t\\t^2\\t^3\end{bmatrix}
$$
上述的四个Bernstein多项式加权和的图像如下

![image-20240528131144881](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240528131144881.png)

因为贝塞尔曲线会插值点$P_0$和点$P_1$，因此，可以得到
$$
B_{3,k}(0)=\begin{cases}1, \text{if} \space \space  k=0 \\
                     0, \text{if} \space \space k=1,2,3\end{cases}
$$
以及
$$
B_{3,k}(1)=\begin{cases}1, \text{if} \space \space  k=0,1,2 \\
                     0, \text{if} \space \space k=3\end{cases}
$$
另外，关于多项式$B(t)$，还需要满足：
$$
\sum_{k=0}^{3}{B_{3,k}(t)}=1
$$
下图展示一些贝塞尔曲线可能出现的形状。贝塞尔曲线的一个很有用的性质是，曲线会被包裹在控制点的凸包范围内。包含四个控制点的最小四面体也包含了曲线$B(t)$上在$t=0\text{和}t=1$区间内的所有点。这是因为，Bernstein多项式在区间$[0,1]$的和是单位1。

![image-20240528195417843](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240528195417843.png)



关于$B(t)$的导数，可以表示曲线的切线方向，如下式所示
$$
B'(t) = \begin{bmatrix}P_0&P_1&P_2&P_3\end{bmatrix}\begin{bmatrix}-3 & 6 &-3\\
3&-12&9\\0&6&-9\\0&0&3\end{bmatrix}\begin{bmatrix}1\\t\\t^3\end{bmatrix}
$$
把$t=0$和$t=1$分别代入可以得到
$$
B'(0)=3(P_1-P_0)\\
B'(1)=3(P_3-P_2)
$$
 可以看出，端点处的切线，是由和端点相邻的两个点的差值的倍数得到的。这个机制，将有助于我们方便的做贝塞尔和Hermite的转换。 现在，我们用$P_0$和$P_3$作为Hermite的端点，对应的切线分别为$T_1$，$T_2$。现在，要从Hermite转换到贝塞尔，可以得到下面的公式：
$$
P_1 = P_0 + \frac{T_1}{3} \\
P_2 = P_3 - \frac{T_2}{3}
$$

### Bezier Curve Truncation

 上面的式子，对于计算在一个贝塞尔曲线内的做子线段截断。具体的意思就是，由于贝塞尔曲线会被规范在控制点的闭包内，而我们可以在外围控制点内，额外加控制点，来截断曲线，控制里面的某一段，如下图所示。

![](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240531145207061.png)

如上图所示，曲线$B_p(t)$的控制点为$P_0,P_1,P_2,P_3$，区间为$[0, 1]$。现在在区间$[t_0, t_1]$创建一个曲线$B_Q(u)$，控制点为$Q_0, Q_1,Q_2,Q_3$, 新曲线自变量$u$是关于$t$的函数，满足如下
$$
t(u)=t_0+(t_1-t_0)u
$$
端点$Q_0$和$Q_3$很容易可以求得
$$
Q_0 = B_p(t_0)\\
Q_1 = B_p(t_1)
$$
关于点$Q_1$和$Q_2$，可以用上面的切线公式计算出来，但是这里必须使用$u$作为参数去计算。
$$
B_Q(u)=B_p(t(u))
$$
现在使用链式法则求导，可以得到
$$
\frac{d}{du}B_Q(u)=\frac{d}{dt}B_p(t(u))\frac{d}{du}t(u) \\
= (t_1-t_0)B'_p(t_0+(t_1-t_0)u)
$$
切线$T_0$和$T_1$对应$u=0$和$u=1$，代入得出
$$
T_0 = B'_Q(0) = (t_1-t_0)B'_P(t_0)\\
T_3 = B’_Q(1) = (t_1-t_0)B'_P(t_1)
$$
因此，可以计算出控制点$Q_1$，$Q_2$：
$$
Q_1=Q_0+\frac{T_0}{3} = Q_0 + \frac{t_1-t_0}{3}B'_P(t_0)\\
Q_2 = Q_3 - \frac{T_3}{3} = Q_3 - \frac{t_1-t_0}{3}B'_P(t_1)
$$

### The de Casteljau Algorithm

这个算法提供了一种几何构造方法，可以通过一个任意的参数$t\in{[0,1]}$将曲线分成两部分。构造的时候，我们得到对应的两个细分曲线的四个控制点。

例如，我们要分割曲线$B_p(t)$，它有四个控制点为$P_0,P_1,P_2,P_3$, 我们在$t=s$的地方去创建两个新的曲线$B_Q(u)$和$B_R(v)$,分别在区间$[0,s]$和$[s,1]$与原曲线保持一致。代入上一小节的公式，可以得到$B_Q(u)$的控制点$Q_0,Q_1,Q_2,Q_3$的等式如下：
$$
Q_0=B_P(0) = P_0 \\
Q_1=B_P(0)+\frac{s}{3}B'_P(0)\\
Q_2=B_P(s)-\frac{s}{3}B'_P(s)\\
Q_3 = B_P(s)
$$


计算得：
$$
Q_1=(1-s)P_0+sP_1=(1-s)Q_0+sP_1\\
Q_2=(1-s)[(1-s)P_0 + sP_1]+s[(1-s)P_1+sP_2]\\
=(1-s)Q_1+s[(1-s)P_1+sP_2]
$$


同理$B_R(v)$的控制点也可以得出
$$
R_0 = B_P(s)\\
R_1 = B_P(s)+\frac{1-s}{3}B'_P(s)\\
R_2 = B_P(1)-\frac{1-s}{3}B'_P(1)\\
R_3=B_P(1)=P_3
$$
计算得：
$$
R_2=(1-s)P_2+sP_3=(1-s)P_2+sR_3\\
R_1 = (1-s)[(1-s)P_1+sP_2]+s[(1-s)P_2+sP_3]\\
=(1-s)[(1-s)P_1+sP_2]+sR_2
$$


最后，我们来观察$Q_3=R_0$这个点。如下图所示，这个点连接$Q_2$跟$R_1$所形成得线段，正好是曲线$B_P(t)$的切线。如果我们把$t=s$代入，就可以得到
$$
B_P(s) = (1-s)Q_2 + sR_1
$$
![image-20240603194703979](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240603194703979.png)

如上图所示，连接四个控制点$P_0，P_1,P_2,P_3$得到三个线段。然后我们通过下面的公式对每一个线段进行线性插值，得出新的点$P_{0}^{(1)},P_{1}^{(1)},P_{2}^{(1)}$:
$$
P_{i}^{1} = (1-s)P_i+sP_{i+1}
$$
现在对新的点重复这个步骤，可以得出一个递推公式：
$$
P_{i}^{(k)}=(1-s)P_{i}^{(k-1)}+sP_{i+1}^{(k-1)}
$$
因为$P_i^{(0)}\equiv{P_i}$。所以可以得出：
$$
Q_i = P_0^{i}\\
R_i=P_i^{(3-i)}
$$

## Catmull-Rom Splines

给定一个有n+1个点的点集$\{P_0,P_1,...,P_n\} (n\ge3)$,Catmull-Rom spline会对点$\{P_1,P_2,...,P_{n-1}\}$进行分段的三次曲线插值。点$P_i$切线向量$T$由下面的公式给出：
$$
T_i=\frac{1}{2}(P_{i+1}-P_{i-1})
$$
我们可以用下面的式子表示每一个分段$C_i(t)$，当$1\le{i}\le{n-2}$,Hermite曲线有端点$P_i$和$P_{i+1}$，且切线$T_i$和$T_{i+1}$：
$$
C_{i}(t)=[P_i \space \space P_{i+1} \space \space T_{i} \space \space T_{i+1}]M_H\begin{bmatrix} 1 \\t\\t^2\\t^3\end{bmatrix}
$$
现在我们需要找到一个基础的矩阵$M_{CR}$，让我们可以用四个点来表示几何矩阵$G_{CR}$：
$$
[P_i \space \space P_{i+1} \space \space T_{i} \space \space T_{i+1}] = [P_{i-1}\space\space P_{i}\space\space P_{i+1}\space\space P_{i+2}]\begin{bmatrix}0&0&-\frac{1}{2}&0\\1&0&0&-\frac{1}{2}\\0&1&\frac{1}{2}&0\\0&0&0&\frac{1}{2}\end{bmatrix}
$$
将上面的式子代入，可以得到：
$$
M_{CR} = \frac{1}{2}\begin{bmatrix}0&0&-1&0\\2&0&0&-1\\0&2&1&0\\0&0&0&1\end{bmatrix}\begin{bmatrix}1&0&-3&2\\0&0&3&-2\\0&1&-2&1\\0&0&-1&1\end{bmatrix}=\frac{1}{2}\begin{bmatrix}0&-1&2&-1\\2&0&-5&3\\0&1&4&-3\\0&0&-1&1\end{bmatrix}
$$
现在，可以把分段样条的表达式写为：
$$
C_i(t)=\begin{bmatrix}P_{i-1}&P_{i}&P_{i+1}&P_{i+2}\end{bmatrix}M_{CR}\begin{bmatrix}1\\t\\t^2\\t^3\end{bmatrix}
$$
$\begin{bmatrix}P_{i-1}&P_{i}&P_{i+1}&P_{i+2}\end{bmatrix}$是几何矩阵$G_{CR}$ 。下图展示了一个由四个样条组成的曲线。



![image-20240520184718638](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240520184718638.png)

## Cubic Splines

目前位置，我们尝试的分段三次曲线，都是局部控制的。也就是说， 调整某一个几何控制点，只会影响到当前分段以及其相邻分段的曲线。现在我们来尝试一种不一样的曲线叫做Cubic Splines。Cubic Splines使用全局控制，即调整其中一个控制点，将会影响到整条完整的曲线。



Cubic spline（三次样条）就是一个通过插值给定点集且满足$C^2$参数连续性的三次多项式的集合。三次样条除了需要插值的点以外不需要几何约束，例如切线方向和控制点。我们可以将三次样条推导为一组标量函数$S_i(x)$。通过给每一个坐标独立的构造三次样条，可以拓展到一组三维点的参数插值。



例如，我们有一个包含$n+1$个点的点集$\{<x_0,y_0>,<x_1,y_1>,...,<x_n,y_n>\}$,且满足$x_i<x_{i+1} $当$0\le{i}\le{n-1}$。我们希望找到$n$个三次多项式$\{S_0(x),S_1{x},...,S_{n-1}(x)\}$,并且每一个$S_i(x)$定义域都在区间$[x_i, x_{i+1}]$。
$$
S_i(x_{i+1})=S_{i+1}(x_{i+1})\\
S'_{i}(x_{i+1})=S'_{i+1}(x_{i+1})\\
S’’_i(x_{i+1})=S''_{i+1}(x_{i+1})
$$
定义两个常量$h_i$和$k_i$，在$0\le{i}\le{n-1}$:
$$
h_i = x_{i+1}-x_{i}\\
k_i=y_{i+1}-y_{i}
$$
我们通过选择满足上面二阶参数连续性的点进行插值来构造三次样条，可以得到下面的公式:
$$
S''_i(x)=\frac{y''_i}{h_i}(x_{i+1}-x)+\frac{y''_{i+1}}{h_i}(x-x_i)
$$
上面的方程常量$y''_n$目前还没确定，但上式始终满足$C^2$。现在对$S''_i(x)$进行两次积分，可以得到0阶导：
$$
S_i(x)=\frac{y''_{i}}{6h_i}(x_{i+1}-x)^3+\frac{y''_{i+1}}{6h_i}(x-x_i)^3+C_i{x}+D_i
$$
其中$C_i$和$D_i$是积分常量，为了方便起见，我们把任意的线性多项式$C_ix+D_i$表示为：
$$
A_i(x_{i+1}-x)+B_i(x-x_i)
$$
代入得：
$$
S_i(x)=\frac{y''_i}{6h_i}(x_{i+1}-x)^3+\frac{y''_{i+1}}{6h_i}(x-x_i)^3+A_i(x_{i+1}-x)+B_i(x-x_i)
$$
将$S_i(x_i)=y_i$和$S_i(x_{i+1})=y_{i+1}$代入可以得出：
$$
y_i=\frac{y''_i}{6}h_i^2+A_ih_i\\
y_{i+1}=\frac{y''_{i+1}}{6}h_i^2+B_ih_i
$$
从上式也可以推断出$A_i$和$B_i$的值：
$$
A_i=\frac{y_i}{h_i}-\frac{y''_ih_i}{6}\\
B_i=\frac{y_{i+1}}{h_i}-\frac{y''_{i+1}h_i}{6}
$$
将其代入$S_i(x)$的等式得：
$$
S_i(x)=\frac{y''_i}{6h_i}(x_{i+1}-x)^3+\frac{y''_{i+1}}{6h_i}(x-x_i)^3+(\frac{y_i}{h_i}-\frac{y''_ih_i}{6})(x_{i+1}-x)\\+(\frac{y_{i+1}}{h_i}-\frac{y''_{i+1}h_i}{6})(x-x_i)
$$
求导得：
$$
S'_i(x)=-\frac{y''_i}{2h_i}(x_{i+1}-x)^2+\frac{y''_{i+1}}{2h_i}(x-x_i)^2+\frac{k_i}{h_i}+\frac{h_i}{6}(y''_i+y''_{i+1})
$$
因为满足$S'_i(x_{i+1})=S'_{i+1}(x_{i+1})$，可以得出以下$n-1$个等式：
$$
h_iy''_i+2(h_i+h_{i+1})y''_{i+1}+h_{i+1}y''_{i+2}=6(\frac{k_{i+1}}{h_{i+1}}-\frac{k_i}{h_i})；0\le{i}\le{n-2}
$$

由于存在$n+1$个未知的$y''_0,y''_1,...,y''_n$，上式的解集是在一个二维的空间。（有$n+1$个未知数，却只有$n-1$个方程，会有自由解，因此解集是二维空间）。我们可以通过选择将端点的二阶导$y''_0$和$y''_n$移动到等式右边来把解减少到单一解，这样就满足$n-1$个未知数对应$n-1$个等式，可以写成以下等式：

![image-20240606152541924](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240606152541924.png)

上面的等式的参数矩阵式一个三对角且对角占优矩阵，可以很方便的求解出$\{y''_i\}_{i=1}^{n-1}$。可以详见《线性系统》章节。

下图展示了$y''_0=y''_n=0$的自然三次样条。

![image-20240607152447346](https://raw.githubusercontent.com/eatdreamcat/PicGo-01/main/image-20240607152447346.png)



## B-Splines









### Uniform B-Splines







### B-Spline Globalization





### Nonuniform B-Splines









### NURBS









## Bicubic Surfaces







## Curvature and Torsion











## 实现

仓库地址：

https://github.com/eatdreamcat/CurveRendering



